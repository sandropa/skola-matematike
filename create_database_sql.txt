
CREATE TABLE problems (
    id SERIAL PRIMARY KEY,
    latex_text TEXT NOT NULL,
    comments TEXT,
    latex_versions TEXT[], -- PostgreSQL array for multiple versions
    solution TEXT,
    category VARCHAR(1) NOT NULL CHECK (category IN ('A', 'N', 'G', 'C'))
);

CREATE INDEX idx_problems_id ON problems(id);

CREATE TABLE problemsets (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    type VARCHAR(100) NOT NULL,
    part_of VARCHAR(100) NOT NULL
);

CREATE INDEX idx_problemsets_id ON problemsets(id);

CREATE TABLE problemset_problems (
    id_problem INTEGER NOT NULL REFERENCES problems(id) ON DELETE CASCADE,
    id_problemset INTEGER NOT NULL REFERENCES problemsets(id) ON DELETE CASCADE,
    PRIMARY KEY (id_problem, id_problemset)
);


ALTER TABLE problemset_problems ADD COLUMN position INTEGER;
ALTER TABLE problemsets ADD COLUMN group_name VARCHAR(30);